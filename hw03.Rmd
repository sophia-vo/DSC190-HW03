---
title: "Statistical Analysis of CMV DNA Data"
output: pdf_document
date: "2024-11-10"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(kableExtra)
hcmv_data <- read.table("hcmv.txt", header = TRUE, sep="")
sequence_length <- 229354
num_palindromes <- 296
```

## Contribution

# 1. Introduction

Cytomegalovirus (CMV) is a complex DNA virus with a genome comprising 229,354 base pairs. DNA sequences contain many patterns, and some of these patterns may flag important sites on the DNA, such as the origin of replication. The origin of replication is special patterns in the virusâ€™ DNA that contains instructions for its reproduction. To develop strategies for combating the virus, scientists want study the way in which the virus replicates. Our analysis uses data from the DNA sequence of CMV that was published in 1990 (Chee etal.) that is 229,354 letters long. Leung et al. (1991) implemented search algorithms to screen the sequence for many types of patterns. Altogether, 296 palindromes were found that were at least 10 letters long, with the longest being 18 letters.

The primary goal of this statistical analysis is to assess how the distribution of palindromes deviates from a uniform scatter across the DNA sequence and if any clusters are due to random chance. We found that [**results of section 2.1 and 2.2**]. Analysis of palindrome counts revealed that shorter intervals had greater variability than larger intervals and that certain region lengths (500, 20000, 50000) showed clustering, suggesting that these areas are less likely to occur by random chance. Further exploration of these clusters showed statistically significant clustering at region length 500.

The report is structured as follows: Section 1 introduces this study's objectives, background, and key questions, Section 2 analyzes the randomness of palindrome distribution, spatial patterns of palindromic sequences, palindrome counts in different genome regions, and the presence of significant clusters. Section 3 explores [**advanced analysis topic**]. Section 4 summarizes the findings and discusses possible methods for searching for the origin of replication.

# 2. Analysis

## 2.1 

### 2.1.1 Methods

### 2.1.2 Analysis

### 2.1.3 Conclusion

## 2.2 

### 2.2.1 Methods

### 2.2.2 Analysis

### 2.2.3 Conclusion

## 2.3 Palindrome Counts

### 2.3.1 Methods

To examine palindrome counts in different regions of DNA, we split the DNA sequence into equal-length, non-overlapping regions, counted the palindromic sequences in each, and compared these counts to those expected from a uniform random scatter. To visualize the results, we graphed histograms to visualize the distribution of palindrome counts across regions. We then used Chi-Square Goodness of Fit Tests to compare observed palindrome counts to expected counts, testing the hypothesis of a uniform random distribution of palindromic sequences across regions.

### 2.3.2 Analysis

The histograms and Chi-Square Test results are shown below.

```{r, echo=FALSE, fig.width=7, fig.height=3}
region_lengths <- c(500, 1000, 5000, 10000, 20000, 50000)

#Chi-Square Test Results Table
chi_square_results <- data.frame(
  `Region Length` = integer(),
  `Chi-Square Statistic` = numeric(),
  `p-value` = numeric(),
  `Interpretation` = character()
)

# Function for analyzing palindromes
analyze_palindromes <- function(region_length) {
  # Total number of non-overlapping regions
  num_regions <- ceiling(sequence_length / region_length)
  
  # Define region breaks and count palindromes in each interval
  region_breaks <- seq(1, sequence_length, by = region_length)
  
  # Count occurrences in each interval
  region_indices <- cut(hcmv_data$location, breaks = region_breaks, include.lowest = TRUE, labels = FALSE)
  counts <- table(region_indices)
  
  # Initialize counts vector with zeros for all regions
  counts_vector <- rep(0, num_regions)
  
  # Fill counts_vector based on the numeric indices
  counts_vector[as.numeric(names(counts))] <- as.vector(counts)
  
  # Expected count per region under uniform distribution
  expected_count <- length(hcmv_data$location) / num_regions
  
  hist(counts_vector, 
       breaks = seq(-0.5, max(counts_vector) + 0.5, by = 1),
       col = "blue", 
       border = "black", 
       main = paste("Palindrome Count Distribution for Region Length =", region_length),
       xlab = "Number of Palindromes per Region", 
       ylab = "Frequency")
  abline(v = expected_count, col = "red", lty = "dashed")
  
  # Classify regions by number of palindromes
  classified_counts <- table(cut(counts_vector, breaks = c(-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, Inf), include.lowest = TRUE))

  # Chi-square test comparing observed to expected uniform distribution
  chi_square_test <- chisq.test(counts_vector, p = rep(1 / num_regions, num_regions), simulate.p.value = TRUE)
  
  interpretation <- ifelse(chi_square_test$p.value < 0.001, 
                           "Significant",
                           "Not Significant")

  chi_square_results <<- rbind(
    chi_square_results,
    data.frame(
      `Region Length` = region_length,
      `Chi-Square Statistic` = chi_square_test$statistic,
      `p-value` = chi_square_test$p.value,
      `Interpretation` = interpretation
    )
  )
  
  return(counts_vector)
}

# Analyze for different region lengths
region_lengths <- c(500, 1000, 5000, 10000, 20000, 50000)
results <- lapply(region_lengths, analyze_palindromes)

kable(chi_square_results, caption = "Chi-Square Test Results") %>%
  kable_styling(latex_options = c("striped", "hold_position"), full_width = FALSE)
```


### 2.3.3 Conclusion

The histograms of palindrome counts revealed that the smaller the region length, the more right skewed the count histogram was, which indicates that shorter regions have a higher frequency of intervals with low or zero palindrome counts, while a few regions have unusually high counts. This is consistent with the idea that smaller regions are more susceptible to variability in palindrome counts. Using a cut-off value of 0.001, the chi-square tests yield significant p-values for very small and very high region lengths, but insignificant p-values for middle region lengths. The significant result at region length 500 suggests that palindromic sequences are clustered in certain small regions rather than being uniformly scattered across the DNA. The non-significant results at the intermediate scales (region lengths 1,000, 5,000, and 10,000) imply that, when viewed at these sizes, the distribution of palindromic sequences appears more uniform. At these lengths, local clusters of palindromic sequences are likely averaged out, resulting in counts that are more consistent with a uniform random distribution. The significant results at region lengths 20,000 and 50,000 indicate that there are large-scale patterns in the distribution of palindromic sequences across broad DNA segments.

## 2.4 The Biggest Cluster

### 2.4.1 Methods

We now want to investigate whether the interval with the highest number of palindromic sequences in a DNA sequence could suggest a potential origin of replication. To do this, we determined if a high-count palindrome cluster deviates significantly from a random scatter and whether such clusters align with features characteristic of origins of replication. Based on prior analysis, region lengths were selected to avoid both overly large and overly small intervals. Small intervals risk splitting clusters across adjacent regions, while large intervals may obscure tight clusters. For each interval, the number of palindromic sequences was counted, yielding a distribution of palindrome counts across intervals and the interval with the highest count of palindromic sequences was identified. Finally, Chi-square goodness of fit tests were applied to determine if the palindrome count in the highest-count interval deviates significantly from expected counts under a random distribution. Histograms were generated to visualize palindrome counts across intervals.

### 2.4.2 Analysis

The results of the Chi-Square Tests across different region lengths is shown below.

```{r, echo=FALSE, fig.width=7, fid.height=3}

# Define region lengths to test
region_lengths <- c(500, 1000, 5000, 10000, 20000, 50000)

# Data frame to store analysis results
palindrome_cluster_results <- data.frame(
  `Region Length` = integer(),
  `Max Count` = numeric(),
  `Max Interval` = integer(),
  `Expected Count` = numeric(),
  `Chi-Square p-value` = numeric(),
  `Interpretation` = character()
)

# Function to analyze palindromic clusters and store results
analyze_palindromic_clusters <- function(region_length) {
  # Define the region breaks
  region_breaks <- seq(1, sequence_length, by = region_length)
  num_intervals <- length(region_breaks) - 1
  
  # Initialize counts vector for each interval
  counts_vector <- rep(0, num_intervals)
  
  # Count palindromes in each interval
  region_indices <- cut(hcmv_data$location, breaks = region_breaks, include.lowest = TRUE, labels = FALSE)
  counts <- table(region_indices)
  counts_vector[as.numeric(names(counts))] <- as.vector(counts)
  
  # Find the maximum palindrome count and its interval
  max_count <- max(counts_vector)
  max_interval <- which(counts_vector == max_count)
  
  # Expected count per interval under uniform distribution
  expected_count <- length(hcmv_data$location) / num_intervals
  
  # Chi-square test for uniform distribution
  chi_square_test <- chisq.test(counts_vector, p = rep(1 / num_intervals, num_intervals), simulate.p.value = TRUE)
  interpretation <- ifelse(chi_square_test$p.value < 0.001, 
                           "Significant", 
                           "Not Significant")

  # Append the results to the palindrome_cluster_results data frame
  palindrome_cluster_results <<- rbind(
    palindrome_cluster_results,
    data.frame(
      `Region Length` = region_length,
      `Max Count` = max_count,
      `Max Interval` = max_interval,
      `Expected Count` = expected_count,
      `Chi-Square p-value` = chi_square_test$p.value,
      `Interpretation` = interpretation
    )
  )
}

# Analyze for each region length and store results
results <- lapply(region_lengths, analyze_palindromic_clusters)

kable(palindrome_cluster_results, caption = "Chi-Square Test Results") %>%
  kable_styling(latex_options = c("striped", "hold_position"), full_width = FALSE)

```

### 2.4.3 Conclusion

As shown in the table above, only the smallest region length (500) showed a significant p-value, while the larger region lengths (1000, 5000, 10000, 20000, and 50000) did not. This suggests that clustering of palindromic sequences exists on a small scale but not over broader intervals. The presence of a high number of palindromic sequences within an interval suggests non-random clustering, which may signal biological importance. Since the statistical analysis shows that the count in this interval is significantly higher than expected by chance, this could imply functional relevance, such as a replication origin.

## 2.5 Discussion

Our statistical analysis can provide insight on how to start experimentally searching for the origin of replication. The results showed a significant clustering of palindromic sequences in small regions (length 500), while larger intervals showed a more uniform distribution. These findings suggest that the origin of replication may lie in one of these dense clusters of palindromic sequences within shorter segments of DNA. Given the statistically significant clustering at region length 500, biologists could begin the experimental search within these smaller regions.

# 3. Advanced Analysis

## 3.1 Methods

## 3.2 Analysis

## 3.3 Conclusion

# 4. Discussion

The primary goal of this analysis was to assess how the distribution of palindromes deviates from a uniform scatter across the DNA sequence and if any clusters are due to random chance. 
